function pluginStrings(){return{langs:{en:{inpageLabels:"Manage in-page link labels",createLabel:"Create",removeLabel:"Remove",createLabelDlgTitle:"Label for in-page link",dlgNameField:"Label name",warnEmpty:"Label name should not be empty",warnBadSymbolInName:"Label name should contain letters and digits only",warnNameFirstNotLetter:"Label name should start with a letter",warnNameExists:"Label with the same name already exists.\nChoose another name",warnBadCaretPos:"Label can not be created in the current position.\nTags permitted for label:\nparagrph,header,list item"},ru:{inpageLabels:"Метки для внутристраничных ссылок",createLabel:"Создать",removeLabel:"Удалить",createLabelDlgTitle:"Метка для внутристраничной ссылки",dlgNameField:"Имя метки",warnEmpty:"Имя метки не должно быть пустым",warnBadSymbolInName:"Имя метки должно состоять только из латинских букв и цифр и\nне должно содержать пробелов и всяких закорючек",warnNameFirstNotLetter:"Имя метки должно начинаться с буквы",warnNameExists:"Метка с таким именем уже существует.\nВыберите другое имя",warnBadCaretPos:"Недопустимая позиция для создания метки.\nОбъектами метки могут быть:\nпараграф,заголовок,элемент списка"}}}}function WarnDlg(e,a,n){var t=e.openModal(n,a);t.find(".trumbowyg-modal-box .trumbowyg-modal-button.trumbowyg-modal-submit").remove(),t.on("tbwcancel",(function(a){e.closeModal()}))}function checkLabelName(e,a){if(!a)return e.lang.warnEmpty;if(!a.match(/^[0-9a-z]+$/))return e.lang.warnBadSymbolInName;if(!a.charAt(0).match(/^[a-z]+$/))return e.lang.warnNameFirstNotLetter;var n=$(".trumbowyg-editor .in-page-label").map((function(){return $(this).attr("id")}));return-1!==$.inArray(a,n)?e.lang.warnNameExists:""}function clearvalidationinfo(){$(".ipl-plugin-validation-text").text("")}function CreateLabelDlg(e,a){var n='<div class="trumbowyg-input-row"><div class="trumbowyg-input-infos"><label for="lbl0000Name">'+e.lang.dlgNameField+'</label></div><div class="trumbowyg-input-html"><input id="lbl0000Name" type="text" style="text-transform: lowercase" onkeypress="clearvalidationinfo()"></input></div></div><div class="ipl-plugin-validation-text"></div>',t=e.openModal(e.lang.createLabelDlgTitle,n);t.on("tbwconfirm",(function(n){var l=t.find("#lbl0000Name").val(),i=checkLabelName(e,l);i?t.find(".ipl-plugin-validation-text").text(i):(e.closeModal(),a(l))})),t.on("tbwcancel",(function(a){e.closeModal()}))}function findPermittedNode(e){if(!e)return null;for(var a=["li","h6","h5","h4","h3","h2","h1","p"],n=0;n<a.length;n++){var t=e.commonAncestorContainer.parentElement.closest(a[n]);if(t)return t}return null}function updateLinks(e,a){for(var n="#"+a,t="a[href$="+a+"]",l=e.doc.body.querySelectorAll(t),i=0;i<l.length;i++)l[i].hash===n&&l[i].replaceWith(l[i].innerText)}!function(e){"use strict";e.extend(!0,e.trumbowyg,pluginStrings());var a={};function n(e){var a=[],n="in-page-label-create",t={text:e.lang.createLabel,hasIcon:!1,fn:function(){e.saveRange();var a=findPermittedNode(e.range);a?CreateLabelDlg(e,(function(e){a.setAttribute("id",e),a.classList.add("in-page-label")})):WarnDlg(e,e.lang.warnBadCaretPos,e.lang.createLabelDlgTitle)}};e.addBtnDef(n,t),a.push(n);var l="in-page-label-remove",i={text:e.lang.removeLabel,hasIcon:!1,fn:function(){if(e.saveRange(),e.range){var a=findPermittedNode(e.range);if(a&&a.classList.contains("in-page-label")){var n=a.getAttribute("id");a.classList.remove("in-page-label"),a.removeAttribute("id"),updateLinks(e,n),e.syncCode(),e.$c.trigger("tbwchange")}}}};return e.addBtnDef(l,i),a.push(l),a}e.extend(!0,e.trumbowyg,{plugins:{inpageLabels:{init:function(t){t.o.plugins.inpageLabels=e.extend(!0,{},a,t.o.plugins.inpageLabels||{});var l={dropdown:n(t),text:"#",title:t.lang.inpageLabels,hasIcon:!1};t.addBtnDef("inpageLabels",l)}}}})}(jQuery);