function pluginStrings(){return{langs:{en:{inpageLabels:"Manage in-page link labels",createLabel:"Create",removeLabel:"Remove",createLabelDlgTitle:"Label for in-page link",dlgNameField:"Label name",warnEmpty:"Label name should not be empty",warnBadSymbolInName:"Label name should contain letters and digits only",warnNameFirstNotLetter:"Label name should start with a letter",warnNameExists:"Label with the same name already exists.\nChoose another name",warnBadCaretPos:"Label can not be created in the current position.\nTags permitted for label:\nparagrph,header,list item"},ru:{inpageLabels:"Метки для внутристраничных ссылок",createLabel:"Создать",removeLabel:"Удалить",createLabelDlgTitle:"Метка для внутристраничной ссылки",dlgNameField:"Имя метки",warnEmpty:"Имя метки не должно быть пустым",warnBadSymbolInName:"Имя метки должно состоять только из латинских букв и цифр и\nне должно содержать пробелов и всяких закорючек",warnNameFirstNotLetter:"Имя метки должно начинаться с буквы",warnNameExists:"Метка с таким именем уже существует.\nВыберите другое имя",warnBadCaretPos:"Недопустимая позиция для создания метки.\nОбъектами метки могут быть:\nпараграф,заголовок,элемент списка"}}}}function WarnDlg(e,a){var t=$(".trumbowyg-editor").trumbowyg("openModal",{title:a,content:e});t.find(".trumbowyg-modal-box .trumbowyg-modal-button.trumbowyg-modal-submit").remove(),t.on("tbwcancel",(function(e){$(".trumbowyg-editor").trumbowyg("closeModal")}))}function checkLabelName(e,a){if(!a)return e.lang.warnEmpty;if(!a.match(/^[0-9a-z]+$/))return e.lang.warnBadSymbolInName;if(!a.charAt(0).match(/^[a-z]+$/))return e.lang.warnNameFirstNotLetter;var t=$(".trumbowyg-editor .in-page-label").map((function(){return $(this).attr("id")}));return-1!==$.inArray(a,t)?e.lang.warnNameExists:""}function clearvalidationinfo(){$(".ipl-plugin-validation-text").text("")}function CreateLabelDlg(e,a){var t='<div class="trumbowyg-input-row"><div class="trumbowyg-input-infos"><label for="lbl0000Name">'+e.lang.dlgNameField+'</label></div><div class="trumbowyg-input-html"><input id="lbl0000Name" type="text" style="text-transform: lowercase" onkeypress="clearvalidationinfo()"></input></div></div><div class="ipl-plugin-validation-text"></div>',n=$(".trumbowyg-editor").trumbowyg("openModal",{title:e.lang.createLabelDlgTitle,content:t});n.on("tbwconfirm",(function(t){var l=n.find("#lbl0000Name").val(),r=checkLabelName(e,l);r?n.find(".ipl-plugin-validation-text").text(r):($(".trumbowyg-editor").trumbowyg("closeModal"),a(l))})),n.on("tbwcancel",(function(e){$(".trumbowyg-editor").trumbowyg("closeModal")}))}function findPermittedNode(e){if(!e)return null;for(var a=["li","h6","h5","h4","h3","h2","h1","p"],t=0;t<a.length;t++){var n=e.commonAncestorContainer.parentElement.closest(a[t]);if(n)return n}return null}!function(e){"use strict";e.extend(!0,e.trumbowyg,pluginStrings());var a={};function t(e){var a=[],t="in-page-label-create",n={text:e.lang.createLabel,hasIcon:!1,fn:function(){e.saveRange();var a=findPermittedNode(e.range);a?CreateLabelDlg(e,(function(e){a.setAttribute("id",e),a.classList.add("in-page-label")})):WarnDlg(e.lang.warnBadCaretPos,e.lang.createLabelDlgTitle)}};e.addBtnDef(t,n),a.push(t);var l="in-page-label-remove",r={text:e.lang.removeLabel,hasIcon:!1,fn:function(){if(e.saveRange(),e.range){var a=findPermittedNode(e.range);a&&a.classList.contains("in-page-label")&&(a.classList.remove("in-page-label"),a.removeAttribute("id"))}}};return e.addBtnDef(l,r),a.push(l),a}e.extend(!0,e.trumbowyg,{plugins:{inpageLabels:{init:function(n){n.o.plugins.inpageLabels=e.extend(!0,{},a,n.o.plugins.inpageLabels||{});var l={dropdown:t(n),text:"#",title:n.lang.inpageLabels,hasIcon:!1};n.addBtnDef("inpageLabels",l)}}}})}(jQuery);